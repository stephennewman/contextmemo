# Context Memo - Product Requirements Document

**Date:** February 4, 2026  
**Version:** 1.0 (Clean Slate)  
**For:** Development Handoff

---

## Executive Summary

Context Memo helps B2B brands get cited by AI assistants (ChatGPT, Claude, Perplexity).

### The Core Insight

**The AI's response is the source of truth.**

When you ask AI "What's the best temperature monitoring solution?", whoever appears in that response has visibility. They might be competitors, industry resources, review sites, or partners. We call them **Entities**.

The brand doesn't get to decide who their competitors are. The AI decides based on what it knows. Our job is to:
1. Discover what entities have visibility for relevant prompts
2. Help the brand win visibility where it matters

### The Core Value Loop

```
Brand Intelligence → Persona-Based Prompts → Run Prompts → Entities Discovered → Visibility Report → Content Generation → Verification
```

---

## Table of Contents

1. [Core Concepts](#1-core-concepts)
2. [Target Customer](#2-target-customer)
3. [System Architecture](#3-system-architecture)
4. [Database Schema](#4-database-schema)
5. [Inngest Functions](#5-inngest-functions)
6. [User Interface](#6-user-interface)
7. [Competitive Moats](#7-competitive-moats)
8. [Technical Specifications](#8-technical-specifications)
9. [Success Metrics](#9-success-metrics)
10. [Implementation Phases](#10-implementation-phases)

---

## 1. Core Concepts

### 1.1 Entities (Not Just Competitors)

When AI responds to a prompt, it cites many types of sources:

| Entity Type | Description | Strategic Goal |
|-------------|-------------|----------------|
| **Competitor** | Direct alternative (same product category) | Beat them on prompts |
| **Partner** | Complementary solution, integration | Be featured alongside |
| **Resource** | Industry publication, gov site, association | Get cited BY them |
| **Aggregator** | Review site (G2, Capterra, TrustRadius) | Get listed/ranked |
| **Publisher** | Blog, news outlet covering the space | Get featured |

This distinction matters because strategy differs by type:
- **Competitors:** Create content to win those prompts
- **Resources:** Get your brand mentioned in their content
- **Aggregators:** Ensure you're listed and well-reviewed
- **Partners:** Appear alongside them, cross-reference

### 1.2 Prompts

Non-branded, high-intent questions that a buyer persona would ask an AI assistant.

**Good prompt:** "What's the best way to automate temperature monitoring for food safety compliance?"

**Bad prompt:** "Tell me about Checkit" (branded, not high-intent)

Prompts are generated by reverse-engineering: "If this persona needed this solution but didn't know the brand existed, what would they ask?"

### 1.3 Visibility

Whether a brand is mentioned or cited when AI responds to a prompt.

- **Cited:** Brand appears in the response with a source link
- **Mentioned:** Brand name appears in the response text
- **Gap:** Brand doesn't appear, but competitors do

### 1.4 Verification

After content is published, we re-run the original prompt to verify the brand now gets cited. This closes the loop and proves the content worked.

---

## 2. Target Customer

### Primary: B2B Marketing Leaders
- **Title:** VP Marketing, Director of Content, Growth Lead
- **Company Size:** 50-500 employees (mid-market)
- **Pain:** Can't prove AI visibility matters; can't scale AI-optimized content
- **Budget:** $200-500/month for tools that prove ROI

### What They Care About (in order)
1. **Pipeline attribution** - Does AI traffic convert to revenue?
2. **Competitive share of voice** - Am I winning vs. competitors?
3. **Content efficiency** - Create smarter content, not more content
4. **Executive reporting** - Show the board that AI visibility matters

### Jobs to Be Done
- "Help me understand if AI is driving pipeline"
- "Show me where competitors beat me in AI search"
- "Create content that AI will actually cite"
- "Prove ROI to my leadership"

---

## 3. System Architecture

### 3.1 The Complete Workflow

```
┌─────────────────────────────────────────────────────────────────┐
│  STEP 1: BRAND INTELLIGENCE EXTRACTION                          │
│                                                                  │
│  User adds domain                                                │
│                                                                  │
│  System crawls:                                                  │
│    - Brand's website                                            │
│    - External sources (web searches about the brand)            │
│                                                                  │
│  Extracts:                                                       │
│    ✓ Products/Services                                          │
│    ✓ Markets/Industries                                         │
│    ✓ Pricing/Packaging                                          │
│    ✓ Offers/Value Props                                         │
│    ✓ Target Personas                                            │
│    ✓ Brand Tone/Voice                                           │
│                                                                  │
│  No entities yet - we don't know who they are                   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  STEP 2: PROMPT GENERATION (Persona-Based)                      │
│                                                                  │
│  For each persona, generate prompts:                            │
│                                                                  │
│  "If this persona needed this solution but didn't know          │
│   the brand existed, what would they ask an AI assistant?"      │
│                                                                  │
│  Requirements:                                                   │
│    - Non-branded (no company names)                             │
│    - High-intent (ready to evaluate solutions)                  │
│    - Conversational (how people talk to AI)                     │
│    - Specific to persona's context                              │
│                                                                  │
│  Output: 5-15 prompts per brand                                 │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  STEP 3: BASELINE SCAN → ENTITIES DISCOVERED                    │
│                                                                  │
│  Run prompts against AI models:                                  │
│    - GPT-4o Mini (via OpenRouter)                               │
│    - Perplexity Sonar (direct API)                              │
│    - Claude 3.5 Haiku (via OpenRouter)                          │
│                                                                  │
│  For each response:                                              │
│    - Is brand mentioned/cited?                                  │
│    - Who else is mentioned/cited? → ENTITIES DISCOVERED         │
│    - Classify entity types (AI + user correction)               │
│                                                                  │
│  Output: Visibility Report                                       │
│    ┌─────────────────────────────────────────────────────────┐  │
│    │  Your Brand: 0/10 prompts (0% visibility)              │  │
│    │                                                         │  │
│    │  COMPETITORS                                            │  │
│    │    SafetyCulture: 5/10 prompts                         │  │
│    │    Zenput: 3/10 prompts                                │  │
│    │                                                         │  │
│    │  RESOURCES                                              │  │
│    │    FDA.gov: 4/10 prompts                               │  │
│    │                                                         │  │
│    │  AGGREGATORS                                            │  │
│    │    G2: 3/10 prompts                                    │  │
│    └─────────────────────────────────────────────────────────┘  │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  STEP 4: DAILY MONITORING                                       │
│                                                                  │
│  Cron: 6 AM ET daily                                            │
│                                                                  │
│  For each brand:                                                 │
│    - Re-run all prompts                                         │
│    - Track changes: first citation, lost citation, streaks      │
│    - Discover new entities as they appear                       │
│    - Emit feed events                                           │
│                                                                  │
│  Feed Events:                                                    │
│    - "Gap: SafetyCulture (competitor) cited, you're not"       │
│    - "Win: First citation on [prompt]!"                         │
│    - "Alert: Lost citation on [prompt]"                         │
│    - "New: G2 (aggregator) appeared - get listed!"             │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  STEP 5: USER ACTIONS                                           │
│                                                                  │
│  Dashboard shows feed with actions:                             │
│                                                                  │
│  [Generate Content]                                              │
│    - Creates article matching brand tone                        │
│    - Syncs to HubSpot                                           │
│    - Schedules verification                                     │
│                                                                  │
│  [Analyze Entity]                                                │
│    - Runs same workflow on any entity                           │
│    - Discovers their prompts                                    │
│    - Shows if YOUR brand appears for THEIR prompts              │
│    - Expands the visibility map                                 │
│                                                                  │
│  [Reclassify]                                                    │
│    - Change entity type (competitor → partner, etc.)            │
│                                                                  │
│  [Dismiss] / [Exclude Prompt]                                    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  STEP 6: CONTENT GENERATION                                     │
│                                                                  │
│  User triggers content for a gap:                               │
│                                                                  │
│  1. Generate article with brand tone                            │
│  2. Include structured data (Schema.org)                        │
│  3. Sync to HubSpot as draft or published                      │
│  4. Submit to IndexNow for search indexing                     │
│  5. Schedule verification (24h, 48h, 72h)                      │
│                                                                  │
│  Memo Types:                                                     │
│    - Comparison (brand vs competitor)                           │
│    - How-to (solve the problem)                                 │
│    - Alternative (brand as alternative to X)                    │
│    - Industry guide (comprehensive topic coverage)              │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  STEP 7: VERIFICATION LOOP                                      │
│                                                                  │
│  24h after content publish:                                      │
│    - Re-run original prompt through models                      │
│    - Check if brand now cited                                   │
│    - Track time-to-citation metric                              │
│    - If not cited, retry at 48h, 72h                           │
│                                                                  │
│  Success: "Verified! Content now cited" (PROVES IT WORKED)     │
│  Pending: "Not yet cited, may need optimization"                │
│                                                                  │
│  Metrics tracked:                                                │
│    - Time to citation (hours)                                   │
│    - Verification rate (% that get cited)                      │
│    - Per-model success                                          │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  STEP 8: REVENUE ATTRIBUTION                                    │
│                                                                  │
│  Daily sync (if HubSpot connected):                             │
│                                                                  │
│  AI Traffic → HubSpot Contact → Deal → Closed Won              │
│                                                                  │
│    - Track visitors from ChatGPT, Perplexity, Claude           │
│    - Match to HubSpot contacts (30-min window)                 │
│    - Track contact → deal → closed won                         │
│    - Calculate attributed revenue                               │
│                                                                  │
│  Dashboard shows:                                                │
│    - AI traffic volume                                          │
│    - Contacts attributed                                        │
│    - Pipeline influenced                                        │
│    - Revenue closed                                             │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  STEP 9: CASCADE (Expand the Visibility Map)                    │
│                                                                  │
│  User clicks "Analyze Entity" on SafetyCulture:                 │
│                                                                  │
│  System runs:                                                    │
│    1. Extract SafetyCulture's context                          │
│    2. Generate SafetyCulture's persona-based prompts           │
│    3. Run those prompts                                         │
│                                                                  │
│  Results show:                                                   │
│    - Does YOUR brand appear for THEIR prompts?                 │
│    - Who else appears? (more entities discovered)              │
│                                                                  │
│  This cascades outward to map the entire landscape:             │
│                                                                  │
│    Your Brand                                                    │
│        │                                                         │
│        ├── Your prompts → SafetyCulture, FDA.gov, G2           │
│        │                                                         │
│        ├── Analyze SafetyCulture                                │
│        │       └── Their prompts → You appear? + more entities │
│        │                                                         │
│        └── Keep cascading to map entire space                   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 3.2 Event Flow

```
brand/created
    └──> context/extract
            └──> query/generate
                    └──> scan/run (first scan)
                            └──> Entities discovered + classified
                            └──> Feed events emitted

[Daily Cron - 6 AM ET]
    └──> daily/run
            └──> scan/run (per brand)
                    └──> New entities discovered
                    └──> Feed events emitted

[User: Generate Content]
    └──> memo/generate
            └──> HubSpot sync
            └──> gap/verify (scheduled +24h)

[User: Analyze Entity]
    └──> cascade/analyze
            └──> context/extract (entity's site)
            └──> query/generate (entity's prompts)
            └──> scan/run
            └──> More entities discovered

[Daily - 8 AM ET]
    └──> attribution/sync
            └──> attribution/sync-deals
```

---

## 4. Database Schema

```sql
-- User accounts
tenants (
  id uuid PRIMARY KEY,
  email text UNIQUE NOT NULL,
  name text,
  stripe_customer_id text,
  plan text DEFAULT 'free',  -- 'free' | 'pro' | 'enterprise'
  created_at timestamptz DEFAULT now()
)

-- Brand profiles
brands (
  id uuid PRIMARY KEY,
  tenant_id uuid REFERENCES tenants NOT NULL,
  name text NOT NULL,
  domain text NOT NULL,
  subdomain text UNIQUE,
  context jsonb,  -- Extracted: products, markets, personas, tone, etc.
  created_at timestamptz DEFAULT now()
)

-- Prompts to monitor
queries (
  id uuid PRIMARY KEY,
  brand_id uuid REFERENCES brands NOT NULL,
  query_text text NOT NULL,
  persona text,  -- Which persona this prompt is for
  
  -- Tracking
  scan_count int DEFAULT 0,
  citation_streak int DEFAULT 0,
  longest_streak int DEFAULT 0,
  current_status text DEFAULT 'never_scanned',  -- 'never_scanned' | 'gap' | 'cited' | 'lost_citation'
  first_cited_at timestamptz,
  last_cited_at timestamptz,
  citation_lost_at timestamptz,
  last_scanned_at timestamptz,
  
  -- Management
  excluded_at timestamptz,
  excluded_reason text,
  created_at timestamptz DEFAULT now()
)

-- Entities discovered from AI responses
entities (
  id uuid PRIMARY KEY,
  brand_id uuid REFERENCES brands NOT NULL,
  name text NOT NULL,
  domain text,
  
  -- Classification
  entity_type text NOT NULL,  -- 'competitor' | 'partner' | 'resource' | 'aggregator' | 'publisher'
  classification_source text DEFAULT 'ai_detected',  -- 'ai_detected' | 'user_set'
  classification_confidence float,
  
  -- Discovery tracking
  discovered_from_query_id uuid REFERENCES queries,
  discovered_at timestamptz DEFAULT now(),
  mention_count int DEFAULT 1,
  last_mentioned_at timestamptz,
  
  -- Cascade analysis (if user analyzes this entity)
  context jsonb,
  context_extracted_at timestamptz,
  
  is_active boolean DEFAULT true,
  created_at timestamptz DEFAULT now()
)

-- Scan results (latest per query per model)
scan_results (
  id uuid PRIMARY KEY,
  query_id uuid REFERENCES queries NOT NULL,
  brand_id uuid REFERENCES brands NOT NULL,
  model text NOT NULL,  -- 'gpt-4o-mini' | 'perplexity-sonar' | 'claude-3-5-haiku'
  
  -- Results
  brand_mentioned boolean DEFAULT false,
  brand_cited boolean DEFAULT false,
  brand_position int,
  entities_mentioned text[],
  citations jsonb,
  response_text text,
  
  -- Delta tracking
  is_first_citation boolean DEFAULT false,
  citation_status_changed boolean DEFAULT false,
  previous_cited boolean,
  
  scanned_at timestamptz DEFAULT now()
)

-- Generated content
memos (
  id uuid PRIMARY KEY,
  brand_id uuid REFERENCES brands NOT NULL,
  query_id uuid REFERENCES queries,
  
  title text NOT NULL,
  slug text NOT NULL,
  content text NOT NULL,
  memo_type text NOT NULL,  -- 'comparison' | 'how-to' | 'alternative' | 'industry'
  schema_json jsonb,  -- Schema.org structured data
  
  -- Publishing
  hubspot_post_id text,
  status text DEFAULT 'draft',  -- 'draft' | 'published'
  published_at timestamptz,
  
  -- Verification
  verified_at timestamptz,
  verification_data jsonb,
  
  created_at timestamptz DEFAULT now()
)

-- Unified activity feed
feed_events (
  id uuid PRIMARY KEY,
  tenant_id uuid REFERENCES tenants NOT NULL,
  brand_id uuid REFERENCES brands NOT NULL,
  
  -- Classification
  workflow text NOT NULL,  -- 'discovery' | 'monitoring' | 'content' | 'verification' | 'attribution'
  event_type text NOT NULL,
  severity text NOT NULL,  -- 'action_required' | 'success' | 'warning' | 'info'
  
  -- Content
  title text NOT NULL,
  message text,
  data jsonb,
  
  -- Related entities
  query_id uuid REFERENCES queries,
  memo_id uuid REFERENCES memos,
  entity_id uuid REFERENCES entities,
  
  -- Actions
  action_available text,  -- 'generate_content' | 'analyze_entity' | 'dismiss' | etc.
  
  -- State
  is_read boolean DEFAULT false,
  resolved_at timestamptz,
  
  created_at timestamptz DEFAULT now()
)

-- Revenue attribution
attribution_events (
  id uuid PRIMARY KEY,
  brand_id uuid REFERENCES brands NOT NULL,
  
  event_type text NOT NULL,  -- 'traffic' | 'contact' | 'deal' | 'closed_won'
  ai_source text,  -- 'chatgpt' | 'perplexity' | 'claude' | etc.
  memo_id uuid REFERENCES memos,
  
  -- HubSpot data
  hubspot_contact_id text,
  hubspot_deal_id text,
  deal_value numeric,
  
  metadata jsonb,
  created_at timestamptz DEFAULT now()
)

-- Usage tracking for billing
usage_events (
  id uuid PRIMARY KEY,
  tenant_id uuid REFERENCES tenants NOT NULL,
  brand_id uuid REFERENCES brands,
  
  event_type text NOT NULL,  -- 'scan' | 'memo_generate' | 'context_extract' | etc.
  credits_used int NOT NULL,
  
  metadata jsonb,
  created_at timestamptz DEFAULT now()
)
```

---

## 5. Inngest Functions

### 5.1 Function List

| Function | Trigger | Description |
|----------|---------|-------------|
| `context/extract` | `brand/created`, `cascade/analyze` | Crawl website, extract brand context |
| `query/generate` | After context extract | Generate persona-based prompts |
| `scan/run` | After query generate, daily cron | Run prompts through AI models, discover entities |
| `memo/generate` | User action | Generate content for a gap |
| `gap/verify` | 24h after memo publish | Re-run prompt to verify citation |
| `cascade/analyze` | User action | Analyze an entity (competitor, resource, etc.) |
| `attribution/sync` | Daily cron | Match AI traffic to HubSpot contacts |
| `attribution/sync-deals` | Daily cron | Track deals and revenue |
| `daily/run` | Cron 6 AM ET | Orchestrate daily scans for all brands |

### 5.2 Function Details

#### `context/extract`
```typescript
// Input
{ brandId: string } | { entityId: string, brandId: string }

// Process
1. Crawl website using Jina Reader (up to 10 pages)
2. If entity analysis, also search for external info
3. Extract via GPT-4o:
   - Products/Services
   - Markets/Industries
   - Pricing/Packaging
   - Target Personas
   - Brand Tone/Voice
4. Save to brands.context or entities.context

// Output
{ success: true, context: {...} }

// Triggers
→ query/generate
```

#### `query/generate`
```typescript
// Input
{ brandId: string }

// Process
1. Load brand context (products, personas)
2. For each persona, generate prompts:
   "If [persona] needed this solution but didn't know
    [brand] existed, what would they ask an AI assistant?"
3. Requirements:
   - Non-branded
   - High-intent
   - Conversational
4. Deduplicate and rank by intent
5. Save to queries table (5-15 per brand)

// Output
{ success: true, queriesCreated: number }

// Triggers
→ scan/run (first scan)
```

#### `scan/run`
```typescript
// Input
{ brandId: string, queryIds?: string[] }

// Process
1. Load queries for brand
2. For each query, for each model (GPT-4o Mini, Perplexity, Claude):
   a. Run prompt through model
   b. Parse response for:
      - Brand mentioned/cited
      - Other entities mentioned/cited
   c. Classify new entities (competitor/partner/resource/etc.)
   d. Track deltas (first citation, lost citation, streak)
   e. Save to scan_results
3. Emit feed events for significant changes
4. Save new entities to entities table

// Output
{ success: true, scanned: number, entitiesDiscovered: number }
```

#### `memo/generate`
```typescript
// Input
{ brandId: string, queryId: string, memoType: string }

// Process
1. Load brand context and query
2. Generate content using brand tone
3. Add Schema.org structured data
4. Save to memos table
5. If HubSpot connected, sync as draft/published
6. Submit to IndexNow
7. Schedule verification (24h)

// Output
{ success: true, memoId: string, hubspotPostId?: string }

// Triggers
→ gap/verify (scheduled +24h)
```

#### `gap/verify`
```typescript
// Input
{ memoId: string }

// Process
1. Load memo and original query
2. Run query through all models
3. Check if brand now cited
4. Calculate time-to-citation
5. Update memo.verified_at if successful
6. Emit feed event
7. If not verified, schedule retry (up to 3 attempts)

// Output
{ success: true, verified: boolean, timeToCitationHours?: number }
```

#### `cascade/analyze`
```typescript
// Input
{ entityId: string, brandId: string }

// Process
1. Extract entity's context (context/extract)
2. Generate entity's prompts (query/generate logic)
3. Run those prompts (scan/run logic)
4. Check if original brand appears
5. Discover more entities
6. Save results linked to original brand

// Output
{ success: true, brandAppearedIn: number, newEntitiesFound: number }
```

---

## 6. User Interface

### 6.1 Key Views

#### Dashboard (Feed View)
- Unified feed of events across all brands
- Filter by: brand, workflow, severity, entity type
- Each event shows: title, message, timestamp, action buttons
- Actions: Generate Content, Analyze Entity, Reclassify, Dismiss

#### Visibility Report
- Shown after first scan completes
- Breakdown by entity type (competitors, resources, aggregators)
- Per-prompt detail available
- Prompt-level actions

#### Brand Settings
- Brand context (editable)
- Personas (add/remove)
- Tone settings
- HubSpot integration
- Auto-publish settings

#### Entity Detail
- Entity classification (editable)
- Mention history
- Prompts where they appear
- [Analyze] button for cascade

#### Memo Detail
- Content preview
- Verification status
- HubSpot sync status
- Edit/Republish actions

#### Attribution Dashboard
- AI traffic funnel visualization
- Traffic → Contacts → Deals → Revenue
- Top-performing content
- Source breakdown (ChatGPT vs Perplexity vs Claude)

### 6.2 Feed Event Types

```typescript
type FeedEventType =
  // Discovery
  | 'baseline_complete'      // First scan done, entities discovered
  | 'new_entity_discovered'  // New entity appeared in scans
  
  // Monitoring
  | 'gap_identified'         // Entity cited, brand not
  | 'first_citation'         // Brand cited for first time on prompt
  | 'citation_lost'          // Brand was cited, now isn't
  | 'streak_milestone'       // 7, 14, 30 day citation streaks
  
  // Content
  | 'memo_generated'         // Content created
  | 'memo_published'         // Pushed to HubSpot
  
  // Verification
  | 'citation_verified'      // Content now gets cited
  | 'citation_pending'       // Not yet verified, will retry
  
  // Attribution
  | 'contact_attributed'     // AI traffic → HubSpot contact
  | 'deal_attributed'        // Contact → deal
  | 'revenue_attributed'     // Deal closed won
```

---

## 7. Competitive Moats

| Moat | Score | Description |
|------|-------|-------------|
| **Closed-Loop Verification** | 95/100 | Only tool that PROVES content worked by re-scanning after publish |
| **Organic Entity Discovery** | 92/100 | Entities revealed by AI responses, not self-reported |
| **Entity Classification** | 91/100 | Distinguish competitors vs partners vs resources vs aggregators |
| **Revenue Attribution** | 90/100 | Connect AI traffic → HubSpot CRM → Revenue |
| **Cascade Analysis** | 88/100 | Analyze any entity to expand the visibility map |
| **HubSpot Marketplace** | 85/100 | First AI citation tool in HubSpot marketplace |
| **Per-Prompt Intelligence** | 80/100 | Track individual prompt performance over time |
| **Brand Tone Matching** | 70/100 | Content matches brand voice automatically |

### Why These Are Defensible

**Closed-Loop Verification:** Competitors can monitor, but proving content worked requires the full loop. "Time to citation" becomes a benchmark only we provide.

**Organic Entity Discovery:** The AI's response is truth. No self-reporting bias. No outdated competitor lists.

**Entity Classification:** Different strategies for different entity types. No one else distinguishes "get cited BY FDA.gov" vs "beat SafetyCulture."

**Revenue Attribution:** Requires HubSpot + AI traffic + contact matching. Data compounds over time.

**Cascade Analysis:** Unique ability to "follow the thread" - analyze any entity to expand the map.

---

## 8. Technical Specifications

### 8.1 AI Models

```typescript
const SCAN_MODELS = [
  { 
    id: 'gpt-4o-mini', 
    displayName: 'GPT-4o Mini', 
    provider: 'openrouter', 
    modelId: 'openai/gpt-4o-mini:online',
  },
  { 
    id: 'perplexity-sonar', 
    displayName: 'Perplexity Sonar', 
    provider: 'perplexity-direct', 
    modelId: 'sonar',
  },
  { 
    id: 'claude-3-5-haiku', 
    displayName: 'Claude 3.5 Haiku', 
    provider: 'openrouter', 
    modelId: 'anthropic/claude-3.5-haiku:online',
  },
]
```

### 8.2 Environment Variables

```bash
# Database
NEXT_PUBLIC_SUPABASE_URL=
NEXT_PUBLIC_SUPABASE_ANON_KEY=
SUPABASE_SERVICE_ROLE_KEY=

# AI Providers
OPENROUTER_API_KEY=
PERPLEXITY_API_KEY=

# Background Jobs
INNGEST_SIGNING_KEY=
INNGEST_EVENT_KEY=

# Integrations
HUBSPOT_CLIENT_ID=
HUBSPOT_CLIENT_SECRET=

# Payments
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=

# Utilities
JINA_API_KEY=
INDEXNOW_API_KEY=
RESEND_API_KEY=
```

### 8.3 Tech Stack

| Component | Technology |
|-----------|------------|
| Frontend | Next.js 16, React 19, Tailwind CSS |
| UI Components | shadcn/ui |
| Database | Supabase (Postgres) |
| Auth | Supabase Auth |
| Background Jobs | Inngest |
| AI | OpenRouter, Perplexity API |
| Web Scraping | Jina Reader |
| Payments | Stripe |
| Email | Resend |
| Hosting | Vercel |

---

## 9. Success Metrics

### North Star
**Verified Citations per Customer per Month**

### Leading Indicators

| Metric | Target |
|--------|--------|
| Prompts scanned per brand | 10-15 |
| Gaps identified per brand | 3-8 |
| Content generated per brand/month | 2-5 |
| Verification rate | 30%+ |
| Time to citation | <72 hours |

### Revenue Metrics

| Metric | Target |
|--------|--------|
| Trial → Paid conversion | 15%+ |
| Monthly churn | <5% |
| LTV:CAC | 3:1+ |

---

## 10. Implementation Phases

### Phase 1: Core Loop (Weeks 1-2)
- Brand context extraction
- Persona-based prompt generation
- Scan execution with entity discovery
- Entity classification (AI-powered)
- Basic visibility report UI

### Phase 2: Monitoring & Feed (Weeks 3-4)
- Daily scan automation
- Feed event system
- Per-prompt tracking (streaks, status)
- Feed UI with actions

### Phase 3: Content & Verification (Weeks 5-6)
- Memo generation with brand tone
- HubSpot integration
- Verification loop
- Verification metrics

### Phase 4: Attribution & Cascade (Weeks 7-8)
- AI traffic tracking
- Revenue attribution
- Cascade analysis feature
- Attribution dashboard

### Phase 5: Billing & Scale (Weeks 9-10)
- Stripe integration
- Usage tracking & limits
- HubSpot Marketplace submission
- Performance optimization

---

**Document End**

*Version 1.0 - February 4, 2026*
